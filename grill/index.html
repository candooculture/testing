<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Candoo Clarity Toolbox</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="clarity-style.css">
</head>

<body>
  <h1>Candoo Clarity Toolbox</h1>

  <div class="intro">
    <h2>Behind the Numbers: Your Hidden Costs, Revealed</h2>
    <p>This toolbox was built for one reason ‚Äî clarity.</p>
    <p>In every business, inefficiencies, churn, and leadership gaps are silently bleeding time, money, and momentum.
    </p>
    <p>We built this suite to surface invisible losses and offer a clear, actionable starting point.</p>
    <p>It‚Äôs not a crystal ball, and it‚Äôs not pretending to be tailored to every company‚Äôs nuance. But it‚Äôs close ‚Äî
      industry benchmarks, smart assumptions, and proven ROI logic are built in to make the invisible‚Ä¶ visible.</p>
    <p>Use it to test scenarios. To validate instincts. To sense-check strategy. Whether you‚Äôre an owner, an operator,
      or a leader who‚Äôs had enough of vague problems and fluffy guesses ‚Äî this is your starting line.</p>
  </div>

  <div class="tabs" id="tabs"></div>
  <div class="content" id="contentContainer">Loading...</div>

  <script>
    const calculators = {
      team_efficiency: { name: "üí∏ Payroll Waste", file: "payroll-waste.html" },
      customer_churn: { name: "üìâ Customer Churn", file: "customer-churn.html" },
      leadership_drag: { name: "üß† Leadership Drag", file: "leadership-drag.html" },
      workforce_productivity: { name: "‚öôÔ∏è Workforce Productivity", file: "workforce-productivity.html" },
      productivity_dive: { name: "üîç Productivity Deep Dive", file: "productivity-dive.html" },
      operational_risk: { name: "üö® Operational Risk", file: "operational-risk.html" },
      __admin__: { name: "‚öôÔ∏è Admin", file: "admin.html", protected: true }
    };

    function loadVisibility() {
      const tabsDiv = document.getElementById('tabs');
      const container = document.getElementById('contentContainer');
      tabsDiv.innerHTML = '';

      Object.keys(calculators).forEach((key) => {
        const { name } = calculators[key];
        const tab = document.createElement('div');
        tab.className = 'tab';
        tab.innerHTML = name;
        tab.onclick = () => switchTab(key, tab);
        tabsDiv.appendChild(tab);
      });

      const firstKey = Object.keys(calculators).find(k => !calculators[k].protected);
      const firstTab = tabsDiv.querySelector('.tab');
      if (firstTab && firstKey) {
        firstTab.classList.add('active');
        switchTab(firstKey, firstTab);
      }
    }

    async function switchTab(key, tabEl) {
      const module = calculators[key];
      if (!module) return;

      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      tabEl.classList.add('active');

      const container = document.getElementById('contentContainer');
      container.innerHTML = '<p>Loading...</p>';

      if (module.protected) {
        const password = prompt("Enter admin password:");
        if (password !== "toolbox12103032") {
          container.innerHTML = '<p style="color:red;">Access denied.</p>';
          return;
        }
      }

      try {
        const response = await fetch(module.file);
        const html = await response.text();

        document.querySelectorAll('script[data-injected]').forEach(script => script.remove());
        container.innerHTML = html;
        document.querySelector('.intro')?.classList.remove('hidden');

        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        tempDiv.querySelectorAll('script').forEach(oldScript => {
          const newScript = document.createElement('script');
          if (oldScript.src) {
            newScript.src = oldScript.src;
          } else {
            newScript.textContent = oldScript.textContent;
          }
          newScript.setAttribute('data-injected', 'true');
          document.body.appendChild(newScript);
        });

      } catch (err) {
        console.error("‚ùå Error loading module:", err);
        container.innerHTML = '<p style="color:red;">Error loading module.</p>';
      }
    }

    window.onload = loadVisibility;
  </script>
</body>

</html>